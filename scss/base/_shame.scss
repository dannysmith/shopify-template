// ==========================================================================
// Stuff that's a bit hacky and needs refactoring.
// ========================================================================== */